<!DOCTYPE html>
<html>

<head>
    <title>Shop Details Form</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }

        h1 {
            text-align: center;
            color: #4285F4;
        }

        form {
            max-width: 800px;
            margin: 0 auto;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            background-color: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .form-group {
            flex-basis: calc(50% - 10px);
            margin: 10px 0;
        }

        label {
            display: block;
            margin-bottom: 5px;
            color: #333;
        }

        input,
        select,
        datalist,
        file,
        textarea {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }

        button {
            width: 100%;
            padding: 10px;
            border: none;
            background-color: #4285F4;
            color: #fff;
            cursor: pointer;
            border-radius: 3px;
            transition: background-color 0.3s;
        }

        .form-group-file input {
            flex: 1;
        }

        button:hover {
            background-color: #3367D6;
        }

        .error {
            color: red;
        }

        /* Responsive Styles */
        @media screen and (max-width: 600px) {
            .form-group {
                flex-basis: 100%;
            }
        }
    </style>
    <script>
        function validateForm() {
            var isValid = true;

            // Validate Email
            var emailInput = document.getElementById('PartyEmailID');
            var emailError = document.getElementById('emailError');
            var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

            if (!emailPattern.test(emailInput.value)) {
                emailError.innerHTML = 'Invalid email address';
                isValid = false;
            } else {
                emailError.innerHTML = '';
            }

            // Validate Phone Number
            var landlineInput = document.getElementById('LandlineNumber');
            var landlineError = document.getElementById('landlineError');
            var mobileInput = document.getElementById('MobileNumber');
            var mobileError = document.getElementById('mobileError');
            var phonePattern = /^\d{10}$/; // Assuming a 10-digit phone number

            if (!phonePattern.test(landlineInput.value)) {
                landlineError.innerHTML = 'Invalid landline number';
                isValid = false;
            } else {
                landlineError.innerHTML = '';
            }

            if (!phonePattern.test(mobileInput.value)) {
                mobileError.innerHTML = 'Invalid mobile number';
                isValid = false;
            } else {
                mobileError.innerHTML = '';
            }

            // Validate image file format
            var businessCardInput = document.getElementById('BusinessCard');
            var shopPhotoInput = document.getElementById('ShopPhoto');
            var imageError = document.getElementById('imageError');
            var allowedImageFormats = ['jpg', 'jpeg', 'png', 'gif'];

            if (!isValidImageFormat(businessCardInput, allowedImageFormats) || !isValidImageFormat(shopPhotoInput, allowedImageFormats)) {
                imageError.innerHTML = 'Invalid image format. Please use JPG, JPEG, PNG, or GIF.';
                isValid = false;
            } else {
                imageError.innerHTML = '';
            }

            return isValid;

            var businessCardInput = document.getElementById('BusinessCard');
            var shopPhotoInput = document.getElementById('ShopPhoto');
            var imageErrors = document.getElementById('imageErrors');
            var allowedImageFormats = ['jpg', 'jpeg', 'png', 'gif'];

            if (!isValidImageFormat(businessCardInput, allowedImageFormats) || !isValidImageFormat(shopPhotoInput, allowedImageFormats)) {
                imageErrors.innerHTML = 'Invalid image format. Please use JPG, JPEG, PNG, or GIF.';
                isValid = false;
            } else {
                imageErrors.innerHTML = '';
            }

            return isValid;
        }

        function isValidImageFormat(input, allowedFormats) {
            var fileName = input.value.toLowerCase();
            var fileExtension = fileName.split('.').pop();

            return allowedFormats.includes(fileExtension);
        }
    </script>
</head>

<body>
    <h1>Shop Details Form</h1>
	<form onsubmit="return validateForm()" name="form" action='https://script.google.com/macros/s/AKfycbxLvcd2mqsxcM3bKu3YpVwW0QmiXrKEBCsMKvFy8rBVjsEeEP2TGP0vkHVdeWndvhe6Hw/exec' method="post">
        <div class="form-group">
            <label for="DealerPartyName">Dealer/Party Name</label>
            <input type="text" id="DealerPartyName" name="DealerPartyName" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="States">State</label>
            <input type="text" id="States" name="States" class="form-control" list="stateList" required>
            <datalist id="stateList">
                <option value="Andhra Pradesh"></option>
                <option value="Arunachal Pradesh"></option>
                <!-- Add other state options -->
            </datalist>
        </div>
        <!-- Repeat the above structure for other form fields -->
        <div class="form-group">
            <label for="CustomerLocation">Customer Location</label>
            <input type="text" id="CustomerLocation" name="CustomerLocation" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="SellinCurrentBrand">Selling Current Brand</label>
            <input type="text" id="SellinCurrentBrand" name="SellinCurrentBrand" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="ActiveType">Active Type</label>
            <input type="text" id="ActiveType" name="ActiveType" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="SalesManName">Salesman Name</label>
            <input type="text" id="SalesManName" name="SalesManName" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="ShopAddress">Shop Address</label>
			<textarea id="w3review" name="shopaddress" rows="2" cols="50"></textarea>        
		</div>
        <div class="form-group">
            <label for="LandlineNumber">Landline Number</label>
            <input type="tel" id="LandlineNumber" name="LandlineNumber" class="form-control" required>
            <span id="landlineError" class="error"></span>
        </div>
        <div class="form-group">
            <label for="ContactPersonName">Contact Person Name</label>
            <input type="text" id="ContactPersonName" name="ContactPersonName" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="Designation">Designation</label>
            <input type="text" id="Designation" name="Designation" class="form-control">
        </div>
        <div class="form-group">
            <label for="MobileNumber">Mobile Number</label>
            <input type="tel" id="MobileNumber" name="MobileNumber" class="form-control" required>
            <span id="mobileError" class="error"></span>
        </div>
        <div class="form-group">
            <label for="PartyEmailID">Party Email ID</label>
            <input type="email" id="PartyEmailID" name="PartyEmailID" class="form-control" required>
            <span id="emailError" class="error"></span>
        </div>
        <div class="form-group">
            <label for="TypeOfStitchingMachine">Type of Stitching Machine</label>
            <input type="text" id="TypeOfStitchingMachine" name="TypeOfStitchingMachine" class="form-control" list="StitchingMachine">
            <datalist id="StitchingMachine">
                <option value="Hand"></option>
                <option value="Conveyor"></option>
            </datalist>
        </div>
        <div class="form-group">
            <label for="ProductType">Product Type</label>
            <input type="text" id="ProductType" name="ProductType" class="form-control" list="productlisting">
            <datalist id="productlisting">
                <option value="Ycone"></option>
                <option value="Jumbo"></option>
            </datalist>
        </div>
        <div class="form-group">
            <label for="BusinessCard">Business Card</label>
            <input type="file" id="BusinessCard" name="BusinessCard" class="form-control-file" accept=".jpg, .jpeg, .png, .gif" required>
        </div>
		<span id="imageError" class="error"></span>
        <div class="form-group">
            <label for="ShopPhoto">Shop Photo</label>
            <div class="form-group-file">
                <input type="file" id="ShopPhoto" name="ShopPhoto" class="form-control-file" accept=".jpg, .jpeg, .png, .gif" required>
            </div>
            <span id="imageErrors" class="error"></span>
        </div>
        <div class="form-group">
            <label for="DealerWebsite">Dealer Website</label>
            <input type="text" id="DealerWebsite" name="DealerWebsite" class="form-control">
        </div>
        <div class="form-group">
            <label for="PurchaseOffice">Purchase Office</label>
            <input type="text" id="PurchaseOffice" name="PurchaseOffice" class="form-control" list="puchaselisting">
            <datalist id="puchaselisting">
                <option value="Plant"></option>
                <option value="Headoffice"></option>
            </datalist>
        </div>

        <br>
        <div>
            <button type="submit">Submit</button>
        </div>
    </form>

      <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbyNyZ9jztyKD5ayyO0zMFJxSfbokI5JINzpLMooHK6gsD1xhgsFNTW3yOcRs4WwckH9Cg/exec'
        const form = document.forms['form']
      
        form.addEventListener('submit', e => {
            if (!validateForm()) {
                // Validation failed, prevent form submission
                e.preventDefault();
                return false;
            }
    
            // Validation passed, proceed with form submission
            e.preventDefault();
            fetch(scriptURL, { method: 'POST', body: new FormData(form)})
                .then(response => alert("Thank you! Your form is submitted successfully." ))
                .then(() => {  window.location.reload(); })
                .catch(error => console.error('Error!', error.message))
        })
    </script>
    

  </body>

</html>
